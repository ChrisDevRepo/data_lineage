CREATE PROC [CONSUMPTION_FINANCE].[spLoadGLCognosData_Test] AS /********************************************************************************************************* Revision history ********************************************************************************************************** 08.08.2025 AD #26999;Update Logic --For Accounts = 'HC100500' PR1 -- Year < 2025 - This is semiannually so we need to split into quarterly using current logic PR2 -- Year >=2025 - direct pull from [STAGING_FINANCE_COGNOS].[v_CCR2PowerBI_facts] PR4 -- Year < 2203 - before 2022 direct pull from [STAGING_FINANCE_COGNOS].[v_CCR2PowerBI_facts --For Accounts <> 'HC100500' PR3 --For Accounts <> 'HC100500' regardless of the year - direct pull from [STAGING_FINANCE_COGNOS].[v_CCR2PowerBI_facts] **********************************************************************************************************/ BEGIN ; BEGIN /* TRY */; -- RAISERROR removed;truncate table [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test]; -- IF removed ;with cte as ( select *, Lag(LocalAmountYTD, 1) over (partition by Company, Dim1, Currency, Year order by Month) as Previous_LocalAmountYTD from [STAGING_FINANCE_COGNOS].[v_CCR2PowerBI_facts] where Account = 'HC100500' ) select *, case when Previous_LocalAmountYTD is NULL then LocalAmountPTD else (LocalAmountYTD - Previous_LocalAmountYTD) end as Fixed_LocalAmountPTD into #thc from cte; -- 2022 and 2023 -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2203 and cast(Periode as int) <= 2312 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 1 ) select cte1.*, (cte1.LocalAmountYTD / 2) as LocalAmountPTD_03, (cte1.LocalAmountYTD / 2) as LocalAmountPTD_06, (cte1.LocalAmountYTD / 2) * (-1) as LocalAmountPTD_09, (cte1.LocalAmountYTD / 2) * (-1) as LocalAmountPTD_12, (cte1.LocalAmountYTD / 2) as LocalAmountYTD_03, cte1.LocalAmountYTD as LocalAmountYTD_06, (cte1.LocalAmountYTD / 2) * (-1) as LocalAmountYTD_09, 0 as LocalAmountYTD_12 into #t00 from cte1 join cte2 on cte1.Company = cte2.Company and cte1.Dim1 = cte2.Dim1 and cte1.Currency = cte2.Currency and cte1.Year = cte2.Year where cte1.Month = '06'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '03' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '03' as [Periode] ,[Year] ,'03' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_03 ,[TransAmountYTD] ,LocalAmountPTD_03 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '06' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '06' as [Periode] ,[Year] ,'06' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_06 ,[TransAmountYTD] ,LocalAmountPTD_06 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2203 and cast(Periode as int) <= 2312 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 1 ) select cte1.*, (cte1.LocalAmountYTD / 2) as LocalAmountPTD_09, (cte1.LocalAmountYTD / 2) as LocalAmountPTD_12, (cte1.LocalAmountYTD / 2) as LocalAmountYTD_09, cte1.LocalAmountYTD as LocalAmountYTD_12 into #t00 from cte1 join cte2 on cte1.Company = cte2.Company and cte1.Dim1 = cte2.Dim1 and cte1.Currency = cte2.Currency and cte1.Year = cte2.Year where cte1.Month = '12'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2203 and cast(Periode as int) <= 2312 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 2 ) select t06.*, (t06.LocalAmountYTD / 2) as LocalAmountPTD_03, (t06.LocalAmountYTD / 2) as LocalAmountPTD_06, ((t12.LocalAmountYTD - t06.LocalAmountYTD) / 2) as LocalAmountPTD_09, ((t12.LocalAmountYTD - t06.LocalAmountYTD) / 2) as LocalAmountPTD_12, (t06.LocalAmountYTD / 2) as LocalAmountYTD_03, t06.LocalAmountYTD as LocalAmountYTD_06, (t06.LocalAmountYTD + (t12.LocalAmountYTD - t06.LocalAmountYTD) / 2) as LocalAmountYTD_09, t12.LocalAmountYTD as LocalAmountYTD_12 into #t00 from cte1 as t06 join cte2 on t06.Company = cte2.Company and t06.Dim1 = cte2.Dim1 and t06.Currency = cte2.Currency and t06.Year = cte2.Year join cte1 as t12 on t12.Company = cte2.Company and t12.Dim1 = cte2.Dim1 and t12.Currency = cte2.Currency and t12.Year = cte2.Year where t06.Month = '06' and t12.Month = '12'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '03' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '03' as [Periode] ,[Year] ,'03' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_03 ,[TransAmountYTD] ,LocalAmountPTD_03 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '06' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '06' as [Periode] ,[Year] ,'06' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_06 ,[TransAmountYTD] ,LocalAmountPTD_06 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- 2024 -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 1 ) select cte1.*, (cte1.LocalAmountYTD / 2) as LocalAmountPTD_03, (cte1.LocalAmountYTD / 2) as LocalAmountPTD_06, (cte1.LocalAmountYTD * (-1)) as LocalAmountPTD_09, (cte1.LocalAmountYTD / 2) as LocalAmountYTD_03, cte1.LocalAmountYTD as LocalAmountYTD_06, 0 as LocalAmountYTD_09 into #t00 from cte1 join cte2 on cte1.Company = cte2.Company and cte1.Dim1 = cte2.Dim1 and cte1.Currency = cte2.Currency and cte1.Year = cte2.Year where cte1.Month = '06'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '03' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '03' as [Periode] ,[Year] ,'03' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_03 ,[TransAmountYTD] ,LocalAmountPTD_03 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '06' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '06' as [Periode] ,[Year] ,'06' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_06 ,[TransAmountYTD] ,LocalAmountPTD_06 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 1 ) select cte1.*, cte1.LocalAmountYTD as LocalAmountPTD_09, (cte1.LocalAmountYTD * (-1)) as LocalAmountPTD_12, cte1.LocalAmountYTD as LocalAmountYTD_09, 0 as LocalAmountYTD_12 into #t00 from cte1 join cte2 on cte1.Company = cte2.Company and cte1.Dim1 = cte2.Dim1 and cte1.Currency = cte2.Currency and cte1.Year = cte2.Year where cte1.Month = '09'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 1 ) select cte1.*, cte1.LocalAmountYTD as LocalAmountPTD_12, cte1.LocalAmountYTD as LocalAmountYTD_12 into #t00 from cte1 join cte2 on cte1.Company = cte2.Company and cte1.Dim1 = cte2.Dim1 and cte1.Currency = cte2.Currency and cte1.Year = cte2.Year where cte1.Month = '12'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,Lag(Month, 1) over (partition by Company, Dim1, Currency, Year order by Month) as Previous_Month from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 2 ) select t09.*, (t06.LocalAmountYTD /2) as LocalAmountPTD_03, (t06.LocalAmountYTD /2) as LocalAmountPTD_06, (t09.LocalAmountYTD - t06.LocalAmountPTD) as LocalAmountPTD_09, (t09.LocalAmountYTD * (-1)) as LocalAmountPTD_12, (t06.LocalAmountYTD /2) as LocalAmountYTD_03, t06.LocalAmountYTD as LocalAmountYTD_06, t09.LocalAmountYTD as LocalAmountYTD_09, 0 as LocalAmountYTD_12 into #t00 from cte1 as t09 join cte2 on t09.Company = cte2.Company and t09.Dim1 = cte2.Dim1 and t09.Currency = cte2.Currency and t09.Year = cte2.Year join cte1 as t06 on t09.Company = t06.Company and t09.Dim1 = t06.Dim1 and t09.Currency = t06.Currency and t09.Year = t06.Year where t09.Month = '09' and t09.Previous_Month = '06' and t06.Month = '06'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '03' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '03' as [Periode] ,[Year] ,'03' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_03 ,[TransAmountYTD] ,LocalAmountPTD_03 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '06' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '06' as [Periode] ,[Year] ,'06' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_06 ,[TransAmountYTD] ,LocalAmountPTD_06 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,Lag(Month, 1) over (partition by Company, Dim1, Currency, Year order by Month) as Previous_Month from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 2 ) select t12.*, (t06.LocalAmountYTD /2) as LocalAmountPTD_03, (t06.LocalAmountYTD /2) as LocalAmountPTD_06, t06.LocalAmountYTD * (-1) as LocalAmountPTD_09, t12.LocalAmountYTD as LocalAmountPTD_12, (t06.LocalAmountYTD /2) as LocalAmountYTD_03, t06.LocalAmountYTD as LocalAmountYTD_06, 0 as LocalAmountYTD_09, t12.LocalAmountYTD as LocalAmountYTD_12 into #t00 from cte1 as t12 join cte2 on t12.Company = cte2.Company and t12.Dim1 = cte2.Dim1 and t12.Currency = cte2.Currency and t12.Year = cte2.Year join cte1 as t06 on t12.Company = t06.Company and t12.Dim1 = t06.Dim1 and t12.Currency = t06.Currency and t12.Year = t06.Year where t12.Month = '12' and t12.Previous_Month = '06' and t06.Month = '06'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '03' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '03' as [Periode] ,[Year] ,'03' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_03 ,[TransAmountYTD] ,LocalAmountPTD_03 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '06' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '06' as [Periode] ,[Year] ,'06' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_06 ,[TransAmountYTD] ,LocalAmountPTD_06 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,Lag(Month, 1) over (partition by Company, Dim1, Currency, Year order by Month) as Previous_Month from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 2 ) select t12.*, t09.LocalAmountYTD as LocalAmountPTD_09, (t12.LocalAmountYTD - t09.LocalAmountYTD) as LocalAmountPTD_12, t09.LocalAmountYTD as LocalAmountYTD_09, t12.LocalAmountYTD as LocalAmountYTD_12 into #t00 from cte1 as t12 join cte2 on t12.Company = cte2.Company and t12.Dim1 = cte2.Dim1 and t12.Currency = cte2.Currency and t12.Year = cte2.Year join cte1 as t09 on t12.Company = t09.Company and t12.Dim1 = t09.Dim1 and t12.Currency = t09.Currency and t12.Year = t09.Year where t12.Month = '12' and t12.Previous_Month = '09' and t09.Month = '09'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- IF removed ;with cte1 as ( select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] from #thc where cast(Periode as int) >= 2403 and cast(Periode as int) <= 2412 ), cte2 as ( select * from ( select Company, Dim1, Currency, Year, count(*) as row_count from cte1 group by Company, Dim1, Currency, Year ) t where row_count = 3 ) select t06.*, (t06.LocalAmountYTD / 2) as LocalAmountPTD_03, (t06.LocalAmountYTD / 2) as LocalAmountPTD_06, (t09.LocalAmountYTD - t06.LocalAmountYTD) as LocalAmountPTD_09, (t12.LocalAmountYTD - t09.LocalAmountYTD) as LocalAmountPTD_12, (t06.LocalAmountYTD / 2) as LocalAmountYTD_03, t06.LocalAmountYTD as LocalAmountYTD_06, t09.LocalAmountYTD as LocalAmountYTD_09, t12.LocalAmountYTD as LocalAmountYTD_12 into #t00 from cte1 as t06 join cte2 on t06.Company = cte2.Company and t06.Dim1 = cte2.Dim1 and t06.Currency = cte2.Currency and t06.Year = cte2.Year join cte1 as t09 on t09.Company = cte2.Company and t09.Dim1 = cte2.Dim1 and t09.Currency = cte2.Currency and t09.Year = cte2.Year join cte1 as t12 on t12.Company = cte2.Company and t12.Dim1 = cte2.Dim1 and t12.Currency = cte2.Currency and t12.Year = cte2.Year where t06.Month = '06' and t09.Month = '09' and t12.Month = '12'; ;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select left([Perakt], 2) + '03' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '03' as [Periode] ,[Year] ,'03' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_03 ,[TransAmountYTD] ,LocalAmountPTD_03 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '06' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '06' as [Periode] ,[Year] ,'06' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_06 ,[TransAmountYTD] ,LocalAmountPTD_06 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '09' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '09' as [Periode] ,[Year] ,'09' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_09 ,[TransAmountYTD] ,LocalAmountPTD_09 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00 union all select left([Perakt], 2) + '12' + right([Perakt], 2) as [Perakt] ,left([Periode], 2) + '12' as [Periode] ,[Year] ,'12' as [Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,LocalAmountYTD_12 ,[TransAmountYTD] ,LocalAmountPTD_12 ,[TransAmountPTD] ,[Vtyp] ,'PR1' as [RecordUpdateType] from #t00; -- 2025 and after -- IF removed;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,'PR2' as [RecordUpdateType] from #thc where cast(Periode as int) >= 2503 -- before 2022 -- IF removed;insert into [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,Fixed_LocalAmountPTD as [LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,'PR4' as [RecordUpdateType] from #thc where cast(Periode as int) < 2203; -- IF removed;truncate table [CONSUMPTION_FINANCE].[GLCognosData_Test]; begin transaction;insert into [CONSUMPTION_FINANCE].[GLCognosData_Test] ( [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] ) select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,[RecordUpdateType] from [STAGING_FINANCE_COGNOS].[GLCognosData_HC100500_Test] union all select [Perakt] ,[Periode] ,[Year] ,[Month] ,[Actuality] ,[Company] ,[Currency] ,[Account] ,[Dim1] ,[Dim2] ,[Dim3] ,[Dim4] ,[Btyp] ,[Etyp] ,[KonsType] ,[JournalNbr] ,[Partner] ,[OriginCompany] ,[TransCurrency] ,[PartnerDim] ,[LocalAmountYTD] ,[TransAmountYTD] ,[LocalAmountPTD] ,[TransAmountPTD] ,[Vtyp] ,'PR3' as [RecordUpdateType] from [STAGING_FINANCE_COGNOS].[v_CCR2PowerBI_facts] where Account <> 'HC100500'; 