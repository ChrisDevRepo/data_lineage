[1m============================= test session starts ==============================[0m
platform linux -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- /home/chris/data_lineage/venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/chris/data_lineage
configfile: pytest.ini
plugins: cov-7.0.0, httpx-0.35.0, anyio-4.11.0
[1mcollecting ... [0mcollected 196 items

tests/api/test_main_api.py::test_health_endpoint [31mFAILED[0m[31m                  [  0%][0m
tests/api/test_main_api.py::test_root_redirects_to_docs [31mFAILED[0m[31m           [  1%][0m
tests/api/test_main_api.py::test_job_status_not_found [32mPASSED[0m[31m             [  1%][0m
tests/api/test_main_api.py::test_job_status_invalid_id_format [31mFAILED[0m[31m     [  2%][0m
tests/api/test_main_api.py::test_job_results_not_found [32mPASSED[0m[31m            [  2%][0m
tests/api/test_main_api.py::test_upload_missing_file [31mFAILED[0m[31m              [  3%][0m
tests/api/test_main_api.py::test_upload_with_mock_parquet [31mFAILED[0m[31m         [  3%][0m
tests/api/test_main_api.py::test_lineage_endpoint_no_data [32mPASSED[0m[31m         [  4%][0m
tests/api/test_main_api.py::test_cors_headers_present [31mFAILED[0m[31m             [  4%][0m
tests/api/test_main_api.py::test_invalid_endpoint_returns_404 [32mPASSED[0m[31m     [  5%][0m
tests/api/test_main_api.py::test_invalid_http_method [31mFAILED[0m[31m              [  5%][0m
tests/api/test_main_api.py::test_full_upload_workflow [33mSKIPPED[0m[31m            [  6%][0m
tests/api/test_main_api.py::test_job_polling_workflow [33mSKIPPED[0m[31m            [  6%][0m
tests/api/test_main_api.py::test_health_endpoint_performance [32mPASSED[0m[31m      [  7%][0m
tests/api/test_main_api.py::test_sql_injection_in_job_id [32mPASSED[0m[31m          [  7%][0m
tests/api/test_main_api.py::test_path_traversal_in_job_id [32mPASSED[0m[31m         [  8%][0m
tests/integration/test_confidence_analysis.py::TestConfidenceDistribution::test_success_rate_is_100_percent [32mPASSED[0m[31m [  8%][0m
tests/integration/test_confidence_analysis.py::TestConfidenceDistribution::test_confidence_100_majority [32mPASSED[0m[31m [  9%][0m
tests/integration/test_confidence_analysis.py::TestConfidenceDistribution::test_confidence_85_acceptable [32mPASSED[0m[31m [  9%][0m
tests/integration/test_confidence_analysis.py::TestConfidenceDistribution::test_confidence_75_acceptable [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_confidence_analysis.py::TestConfidence85Analysis::test_conf_85_sps_have_dependencies [32mPASSED[0m[31m [ 10%][0m
tests/integration/test_confidence_analysis.py::TestConfidence85Analysis::test_conf_85_completeness_range [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_confidence_analysis.py::TestConfidence75Analysis::test_conf_75_sps_have_dependencies [32mPASSED[0m[31m [ 11%][0m
tests/integration/test_confidence_analysis.py::TestConfidence75Analysis::test_conf_75_completeness_range [32mPASSED[0m[31m [ 12%][0m
tests/integration/test_confidence_analysis.py::TestPatternAnalysis::test_lower_confidence_sp_has_sql_patterns [32mPASSED[0m[31m [ 12%][0m
tests/integration/test_confidence_analysis.py::TestCleaningLogicAssessment::test_expected_count_populated [33mSKIPPED[0m[31m [ 13%][0m
tests/integration/test_confidence_analysis.py::TestCleaningLogicAssessment::test_lower_confidence_reasons_identifiable [32mPASSED[0m[31m [ 13%][0m
tests/integration/test_database_validation.py::TestOverallStatistics::test_all_sps_have_dependencies [32mPASSED[0m[31m [ 14%][0m
tests/integration/test_database_validation.py::TestOverallStatistics::test_sps_with_inputs_percentage [32mPASSED[0m[31m [ 14%][0m
tests/integration/test_database_validation.py::TestOverallStatistics::test_sps_with_outputs_percentage [32mPASSED[0m[31m [ 15%][0m
tests/integration/test_database_validation.py::TestConfidenceDistribution::test_confidence_values_are_valid [32mPASSED[0m[31m [ 15%][0m
tests/integration/test_database_validation.py::TestConfidenceDistribution::test_majority_have_perfect_confidence [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_database_validation.py::TestConfidenceDistribution::test_no_zero_confidence_sps [32mPASSED[0m[31m [ 16%][0m
tests/integration/test_database_validation.py::TestAverageDependencies::test_average_inputs_per_sp [31mFAILED[0m[31m [ 17%][0m
tests/integration/test_database_validation.py::TestAverageDependencies::test_average_outputs_per_sp [32mPASSED[0m[31m [ 17%][0m
tests/integration/test_database_validation.py::TestSpecificStoredProcedures::test_sp_exists_and_parsed[spLoadFactLaborCostForEarnedValue_Post] [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_database_validation.py::TestSpecificStoredProcedures::test_sp_exists_and_parsed[spLoadDimTemplateType] [32mPASSED[0m[31m [ 18%][0m
tests/integration/test_database_validation.py::TestSpecificStoredProcedures::test_spLoadFactLaborCostForEarnedValue_Post_has_expected_dependencies [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_database_validation.py::TestTopStoredProcedures::test_top_10_sps_by_dependency_count [32mPASSED[0m[31m [ 19%][0m
tests/integration/test_database_validation.py::TestTopStoredProcedures::test_highest_dependency_sp_has_at_least_5_deps [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_failure_analysis.py::TestFailureIdentification::test_no_failed_sps [32mPASSED[0m[31m [ 20%][0m
tests/integration/test_failure_analysis.py::TestFailureCategorization::test_no_unexpected_failures [33mSKIPPED[0m[31m [ 21%][0m
tests/integration/test_failure_analysis.py::TestFailureCategorization::test_dynamic_sql_failures_expected [33mSKIPPED[0m[31m [ 21%][0m
tests/integration/test_failure_analysis.py::TestFailureCategorization::test_template_empty_failures_expected [33mSKIPPED[0m[31m [ 22%][0m
tests/integration/test_failure_analysis.py::TestPatternAnalysis::test_failed_sp_pattern_matches_category [33mSKIPPED[0m[31m [ 22%][0m
tests/integration/test_failure_analysis.py::TestCleaningLogicAssessment::test_expected_failures_only [33mSKIPPED[0m[31m [ 23%][0m
tests/integration/test_failure_analysis.py::TestCleaningLogicAssessment::test_cleaning_logic_not_too_aggressive [32mPASSED[0m[31m [ 23%][0m
tests/integration/test_failure_analysis.py::TestConclusion::test_parser_health_excellent [32mPASSED[0m[31m [ 24%][0m
tests/integration/test_postgres_mock.py::TestPostgresDialectQueries::test_objects_query_structure [32mPASSED[0m[31m [ 25%][0m
tests/integration/test_postgres_mock.py::TestPostgresDialectQueries::test_definitions_query_structure [32mPASSED[0m[31m [ 25%][0m
tests/integration/test_postgres_mock.py::TestPostgresDialectQueries::test_query_logs_query_structure [32mPASSED[0m[31m [ 26%][0m
tests/integration/test_postgres_mock.py::TestPostgresSchemaCompatibility::test_objects_schema_matches [32mPASSED[0m[31m [ 26%][0m
tests/integration/test_postgres_mock.py::TestPostgresSchemaCompatibility::test_definitions_schema_matches [32mPASSED[0m[31m [ 27%][0m
tests/integration/test_postgres_mock.py::TestPostgresSchemaCompatibility::test_query_logs_schema_matches [32mPASSED[0m[31m [ 27%][0m
tests/integration/test_postgres_mock.py::TestPostgresSchemaCompatibility::test_required_columns_no_nulls [32mPASSED[0m[31m [ 28%][0m
tests/integration/test_postgres_mock.py::TestPostgresDynamicSQLDetection::test_positional_parameters [32mPASSED[0m[31m [ 28%][0m
tests/integration/test_postgres_mock.py::TestPostgresDynamicSQLDetection::test_format_function [32mPASSED[0m[31m [ 29%][0m
tests/integration/test_postgres_mock.py::TestPostgresDynamicSQLDetection::test_execute_using [32mPASSED[0m[31m [ 29%][0m
tests/integration/test_postgres_mock.py::TestPostgresDynamicSQLDetection::test_concatenation [32mPASSED[0m[31m [ 30%][0m
tests/integration/test_postgres_mock.py::TestPostgresDynamicSQLDetection::test_no_false_positives [32mPASSED[0m[31m [ 30%][0m
tests/integration/test_postgres_mock.py::TestPostgresDataQuality::test_objects_data_quality [32mPASSED[0m[31m [ 31%][0m
tests/integration/test_postgres_mock.py::TestPostgresDataQuality::test_definitions_completeness [32mPASSED[0m[31m [ 31%][0m
tests/integration/test_postgres_mock.py::TestPostgresDataQuality::test_query_logs_data [32mPASSED[0m[31m [ 32%][0m
tests/integration/test_postgres_mock.py::TestPostgresVsTSQL::test_schema_consistency [32mPASSED[0m[31m [ 32%][0m
tests/integration/test_postgres_mock.py::TestPostgresVsTSQL::test_key_differences [32mPASSED[0m[31m [ 33%][0m
tests/integration/test_postgres_mock.py::TestPostgresExtraction::test_full_extraction_workflow [32mPASSED[0m[31m [ 33%][0m
tests/integration/test_postgres_mock.py::TestPostgresExtraction::test_dynamic_sql_summary [32mPASSED[0m[31m [ 34%][0m
tests/integration/test_sp_deep_debugging.py::TestRegexExtraction::test_target_sp_exists [32mPASSED[0m[31m [ 34%][0m
tests/integration/test_sp_deep_debugging.py::TestRegexExtraction::test_regex_extracts_from_tables [32mPASSED[0m[31m [ 35%][0m
tests/integration/test_sp_deep_debugging.py::TestRegexExtraction::test_regex_extracts_target_tables [32mPASSED[0m[31m [ 35%][0m
tests/integration/test_sp_deep_debugging.py::TestSQLGlotParsing::test_sqlglot_warn_mode_on_sample [32mPASSED[0m[31m [ 36%][0m
tests/integration/test_sp_deep_debugging.py::TestSQLGlotParsing::test_sqlglot_raise_mode_behavior [32mPASSED[0m[31m [ 36%][0m
tests/integration/test_sp_deep_debugging.py::TestProblematicPatterns::test_identify_problematic_patterns [32mPASSED[0m[31m [ 37%][0m
tests/integration/test_sp_deep_debugging.py::TestProblematicPatterns::test_temp_tables_not_in_dependencies [32mPASSED[0m[31m [ 37%][0m
tests/integration/test_sp_deep_debugging.py::TestExpectedDependencyValidation::test_expected_sources_found_in_regex [32mPASSED[0m[31m [ 38%][0m
tests/integration/test_sp_deep_debugging.py::TestDebuggingWorkflow::test_ddl_length_reasonable [32mPASSED[0m[31m [ 38%][0m
tests/integration/test_sp_deep_debugging.py::TestDebuggingWorkflow::test_sp_has_data_operations [32mPASSED[0m[31m [ 39%][0m
tests/integration/test_sp_parsing_details.py::TestSPDetailedParsing::test_sp_has_confidence_score [32mPASSED[0m[31m [ 39%][0m
tests/integration/test_sp_parsing_details.py::TestSPDetailedParsing::test_sp_input_tables_have_valid_names [32mPASSED[0m[31m [ 40%][0m
tests/integration/test_sp_parsing_details.py::TestSPDetailedParsing::test_sp_output_tables_have_valid_names [32mPASSED[0m[31m [ 40%][0m
tests/integration/test_sp_parsing_details.py::TestPhantomObjectDetection::test_phantom_objects_have_negative_ids [33mSKIPPED[0m[31m [ 41%][0m
tests/integration/test_sp_parsing_details.py::TestPhantomObjectDetection::test_phantoms_are_marked_in_sp_dependencies [33mSKIPPED[0m[31m [ 41%][0m
tests/integration/test_sp_parsing_details.py::TestPhantomObjectDetection::test_phantom_marker_in_output [32mPASSED[0m[31m [ 42%][0m
tests/integration/test_sp_parsing_details.py::TestExpectedDependencies::test_spLoadFactLaborCostForEarnedValue_Post_expected_sources [32mPASSED[0m[31m [ 42%][0m
tests/integration/test_sp_parsing_details.py::TestExpectedDependencies::test_spLoadFactLaborCostForEarnedValue_Post_expected_target [32mPASSED[0m[31m [ 43%][0m
tests/integration/test_sqlglot_performance.py::TestOverallParsingSuccess::test_all_sps_have_dependencies [32mPASSED[0m[31m [ 43%][0m
tests/integration/test_sqlglot_performance.py::TestOverallParsingSuccess::test_average_confidence_high [32mPASSED[0m[31m [ 44%][0m
tests/integration/test_sqlglot_performance.py::TestOverallParsingSuccess::test_regex_baseline_provides_coverage [33mSKIPPED[0m[31m [ 44%][0m
tests/integration/test_sqlglot_performance.py::TestConfidenceDistribution::test_confidence_distribution_valid [32mPASSED[0m[31m [ 45%][0m
tests/integration/test_sqlglot_performance.py::TestConfidenceDistribution::test_confidence_distribution_percentages [32mPASSED[0m[31m [ 45%][0m
tests/integration/test_sqlglot_performance.py::TestCompletenessAnalysis::test_completeness_ranges_distribution [31mFAILED[0m[31m [ 46%][0m
tests/integration/test_sqlglot_performance.py::TestSQLGlotEnhancementImpact::test_sqlglot_adds_tables [33mSKIPPED[0m[31m [ 46%][0m
tests/integration/test_sqlglot_performance.py::TestSQLGlotEnhancementImpact::test_sqlglot_average_tables_added [33mSKIPPED[0m[31m [ 47%][0m
tests/integration/test_sqlglot_performance.py::TestSQLGlotEnhancementImpact::test_top_sps_where_sqlglot_helped [33mSKIPPED[0m[31m [ 47%][0m
tests/integration/test_sqlglot_performance.py::TestPhantomObjectDetection::test_phantom_objects_table_exists [32mPASSED[0m[31m [ 48%][0m
tests/integration/test_sqlglot_performance.py::TestPhantomObjectDetection::test_phantom_objects_count [32mPASSED[0m[31m [ 48%][0m
tests/integration/test_sqlglot_performance.py::TestPhantomObjectDetection::test_phantom_objects_have_schema_and_name [33mSKIPPED[0m[31m [ 49%][0m
tests/integration/test_sqlglot_performance.py::TestKeyInsights::test_regex_baseline_guarantees_coverage [32mPASSED[0m[31m [ 50%][0m
tests/integration/test_sqlglot_performance.py::TestKeyInsights::test_sqlglot_enhances_not_replaces [33mSKIPPED[0m[31m [ 50%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_synapse_parquet_files_exist [32mPASSED[0m[31m [ 51%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_synapse_data_loaded [32mPASSED[0m[31m [ 51%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_synapse_schema_columns [31mFAILED[0m[31m [ 52%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_synapse_object_types [31mFAILED[0m[31m [ 52%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_tsql_schema_compatibility [31mFAILED[0m[31m [ 53%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_synapse_data_quality [31mFAILED[0m[31m [ 53%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_synapse_stored_procedures [31mFAILED[0m[31m [ 54%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_tsql_query_structure [32mPASSED[0m[31m [ 54%][0m
tests/integration/test_synapse_integration.py::TestSynapseIntegration::test_backward_compatibility_mapping [31mFAILED[0m[31m [ 55%][0m
tests/integration/test_synapse_integration.py::TestTSQLQueryLogs::test_query_logs_query_structure [32mPASSED[0m[31m [ 55%][0m
tests/integration/test_synapse_integration.py::TestTSQLQueryLogs::test_dynamic_sql_pattern_validation [32mPASSED[0m[31m [ 56%][0m
tests/unit/config/test_dialect_config.py::TestSQLDialect::test_dialect_enum_values [32mPASSED[0m[31m [ 56%][0m
tests/unit/config/test_dialect_config.py::TestSQLDialect::test_dialect_enum_count [32mPASSED[0m[31m [ 57%][0m
tests/unit/config/test_dialect_config.py::TestSQLDialect::test_dialect_enum_string_coercion [32mPASSED[0m[31m [ 57%][0m
tests/unit/config/test_dialect_config.py::TestValidateDialect::test_validate_lowercase [32mPASSED[0m[31m [ 58%][0m
tests/unit/config/test_dialect_config.py::TestValidateDialect::test_validate_uppercase [32mPASSED[0m[31m [ 58%][0m
tests/unit/config/test_dialect_config.py::TestValidateDialect::test_validate_mixedcase [32mPASSED[0m[31m [ 59%][0m
tests/unit/config/test_dialect_config.py::TestValidateDialect::test_validate_invalid_dialect [32mPASSED[0m[31m [ 59%][0m
tests/unit/config/test_dialect_config.py::TestValidateDialect::test_validate_error_message_includes_supported [32mPASSED[0m[31m [ 60%][0m
tests/unit/config/test_dialect_config.py::TestDialectMetadata::test_all_dialects_have_metadata [32mPASSED[0m[31m [ 60%][0m
tests/unit/config/test_dialect_config.py::TestDialectMetadata::test_tsql_metadata [32mPASSED[0m[31m [ 61%][0m
tests/unit/config/test_dialect_config.py::TestDialectMetadata::test_fabric_metadata [32mPASSED[0m[31m [ 61%][0m
tests/unit/config/test_dialect_config.py::TestDialectMetadata::test_postgres_metadata [32mPASSED[0m[31m [ 62%][0m
tests/unit/config/test_dialect_config.py::TestDialectMetadata::test_oracle_metadata [32mPASSED[0m[31m [ 62%][0m
tests/unit/config/test_dialect_config.py::TestDialectMetadata::test_metadata_registry_complete [32mPASSED[0m[31m [ 63%][0m
tests/unit/config/test_dialect_config.py::TestListSupportedDialects::test_list_returns_all_dialects [32mPASSED[0m[31m [ 63%][0m
tests/unit/config/test_dialect_config.py::TestListSupportedDialects::test_list_returns_list [32mPASSED[0m[31m [ 64%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_default_dialect_is_tsql [32mPASSED[0m[31m [ 64%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_dialect_property_returns_enum [32mPASSED[0m[31m [ 65%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_valid_dialects_accepted [32mPASSED[0m[31m [ 65%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_dialect_case_insensitive [32mPASSED[0m[31m [ 66%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_invalid_dialect_raises_error [32mPASSED[0m[31m [ 66%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_dialect_from_env_variable [32mPASSED[0m[31m [ 67%][0m
tests/unit/config/test_settings.py::TestSettingsDialectConfiguration::test_dialect_env_case_insensitive [32mPASSED[0m[31m [ 67%][0m
tests/unit/config/test_settings.py::TestSettingsBackwardCompatibility::test_parser_settings_still_work [32mPASSED[0m[31m [ 68%][0m
tests/unit/config/test_settings.py::TestSettingsBackwardCompatibility::test_path_settings_still_work [32mPASSED[0m[31m [ 68%][0m
tests/unit/config/test_settings.py::TestSettingsBackwardCompatibility::test_log_level_still_works [32mPASSED[0m[31m [ 69%][0m
tests/unit/config/test_settings.py::TestSettingsBackwardCompatibility::test_debug_mode_still_works [32mPASSED[0m[31m [ 69%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_basic_properties [32mPASSED[0m[31m [ 70%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_metadata_source [32mPASSED[0m[31m [ 70%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_objects_query_valid_sql [32mPASSED[0m[31m [ 71%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_definitions_query_valid_sql [32mPASSED[0m[31m [ 71%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_objects_schema [32mPASSED[0m[31m [ 72%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_definitions_schema [32mPASSED[0m[31m [ 72%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_query_logs_enabled [32mPASSED[0m[31m [ 73%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_query_logs_extraction_query [32mPASSED[0m[31m [ 73%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_query_logs_schema [32mPASSED[0m[31m [ 74%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_dynamic_sql_patterns [32mPASSED[0m[31m [ 75%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_dynamic_sql_pattern_coverage [32mPASSED[0m[31m [ 75%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_parsing_configuration [32mPASSED[0m[31m [ 76%][0m
tests/unit/dialects/test_dialects.py::TestTSQLDialect::test_repr [32mPASSED[0m[31m  [ 76%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_basic_properties [32mPASSED[0m[31m [ 77%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_metadata_source [32mPASSED[0m[31m [ 77%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_objects_query_valid_sql [32mPASSED[0m[31m [ 78%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_definitions_query_valid_sql [32mPASSED[0m[31m [ 78%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_query_logs_extraction_query [32mPASSED[0m[31m [ 79%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_dynamic_sql_patterns [32mPASSED[0m[31m [ 79%][0m
tests/unit/dialects/test_dialects.py::TestPostgresDialect::test_parsing_configuration [32mPASSED[0m[31m [ 80%][0m
tests/unit/dialects/test_dialects.py::TestDialectRegistry::test_get_tsql_dialect [32mPASSED[0m[31m [ 80%][0m
tests/unit/dialects/test_dialects.py::TestDialectRegistry::test_get_postgres_dialect [32mPASSED[0m[31m [ 81%][0m
tests/unit/dialects/test_dialects.py::TestDialectRegistry::test_dialect_caching [32mPASSED[0m[31m [ 81%][0m
tests/unit/dialects/test_dialects.py::TestDialectRegistry::test_is_dialect_implemented [32mPASSED[0m[31m [ 82%][0m
tests/unit/dialects/test_dialects.py::TestDialectRegistry::test_list_implemented_dialects [32mPASSED[0m[31m [ 82%][0m
tests/unit/dialects/test_dialects.py::TestDialectRegistry::test_unimplemented_dialect_raises_error [32mPASSED[0m[31m [ 83%][0m
tests/unit/dialects/test_dialects.py::TestSchemaValidation::test_all_dialects_have_consistent_schemas [32mPASSED[0m[31m [ 83%][0m
tests/unit/dialects/test_dialects.py::TestSchemaValidation::test_required_columns_marked_correctly [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_basic_input_hints [32mPASSED[0m[31m [ 84%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_basic_output_hints [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_both_input_and_output_hints [32mPASSED[0m[31m [ 85%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_multiple_hint_comments [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_bracketed_table_names [32mPASSED[0m[31m [ 86%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_mixed_bracket_formats [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_no_schema_defaults_to_dbo [32mPASSED[0m[31m [ 87%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_whitespace_handling [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_case_insensitive_keywords [32mPASSED[0m[31m [ 88%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_hints_in_catch_block [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_hints_in_conditional_logic [32mPASSED[0m[31m [ 89%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_dynamic_sql_documentation [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_empty_ddl [32mPASSED[0m[31m [ 90%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_no_hints [32mPASSED[0m[31m [ 91%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_invalid_hint_format_ignored [31mFAILED[0m[31m [ 91%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_duplicate_hints_deduplicated [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_hint_stats [32mPASSED[0m[31m [ 92%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_real_world_example_1 [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_comment_hints_parser.py::TestCommentHintsParser::test_real_world_example_2 [32mPASSED[0m[31m [ 93%][0m
tests/unit/test_parser_golden_cases.py::TestParserGoldenCases::test_spLoadFactLaborCostForEarnedValue_golden [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_parser_golden_cases.py::TestParserGoldenCases::test_spLoadDimTemplateType_golden [32mPASSED[0m[31m [ 94%][0m
tests/unit/test_parser_golden_cases.py::TestParserGoldenCases::test_detect_warn_mode_regression [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_parser_golden_cases.py::TestParserGoldenCases::test_cross_join_detected [32mPASSED[0m[31m [ 95%][0m
tests/unit/test_parser_golden_cases.py::TestParserSimplifiedConfidence::test_confidence_is_discrete [31mERROR[0m[31m [ 96%][0m
tests/unit/test_parser_golden_cases.py::TestParserSimplifiedConfidence::test_completeness_mapping [32mPASSED[0m[31m [ 96%][0m
tests/unit/test_parser_golden_cases.py::TestErrorLevelBehavior::test_raise_mode_fails_fast [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_parser_golden_cases.py::TestErrorLevelBehavior::test_warn_mode_silent_failure [32mPASSED[0m[31m [ 97%][0m
tests/unit/test_parser_golden_cases.py::TestErrorLevelBehavior::test_ignore_mode_completely_silent [32mPASSED[0m[31m [ 98%][0m
tests/unit/test_user_verified_cases.py::test_user_verified_case[NOTSET] [33mSKIPPED[0mrs report issues))[31m [ 98%][0m
tests/unit/test_user_verified_cases.py::test_no_duplicate_case_names [32mPASSED[0m[31m [ 99%][0m
tests/unit/test_user_verified_cases.py::test_verified_cases_changelog_sync [33mSKIPPED[0m[31m [100%][0m

==================================== ERRORS ====================================
[31m[1m_ ERROR at setup of TestParserSimplifiedConfidence.test_confidence_is_discrete _[0m
file /home/chris/data_lineage/tests/unit/test_parser_golden_cases.py, line 160
      def test_confidence_is_discrete(self, parser):
[31mE       fixture 'parser' not found[0m
[31m>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, cov, doctest_namespace, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, httpx_mock, monkeypatch, no_cover, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory[0m
[31m>       use 'pytest --fixtures [testpath]' for help on them.[0m

/home/chris/data_lineage/tests/unit/test_parser_golden_cases.py:160
=================================== FAILURES ===================================
[31m[1m_____________________________ test_health_endpoint _____________________________[0m
[1m[31mtests/api/test_main_api.py[0m:68: in test_health_endpoint
    [0m[94massert[39;49;00m [33m"[39;49;00m[33mtimestamp[39;49;00m[33m"[39;49;00m [95min[39;49;00m data[90m[39;49;00m
[1m[31mE   AssertionError: assert 'timestamp' in {'status': 'ok', 'version': '4.0.3', 'uptime_seconds': 0.26912546157836914}[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
[31m[1m_________________________ test_root_redirects_to_docs __________________________[0m
[1m[31mtests/api/test_main_api.py[0m:76: in test_root_redirects_to_docs
    [0m[94massert[39;49;00m response.status_code [95min[39;49;00m [[94m301[39;49;00m, [94m302[39;49;00m, [94m307[39;49;00m, [94m308[39;49;00m][90m[39;49;00m
[1m[31mE   assert 404 in [301, 302, 307, 308][0m
[1m[31mE    +  where 404 = <Response [404 Not Found]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: GET http://testserver/ "HTTP/1.1 404 Not Found"
[31m[1m______________________ test_job_status_invalid_id_format _______________________[0m
[1m[31mtests/api/test_main_api.py[0m:105: in test_job_status_invalid_id_format
    [0mresponse = client.get([33mf[39;49;00m[33m"[39;49;00m[33m/api/job/[39;49;00m[33m{[39;49;00minvalid_id[33m}[39;49;00m[33m/status[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/starlette/testclient.py[0m:518: in get
    [0m[94mreturn[39;49;00m [96msuper[39;49;00m().get([90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/httpx/_client.py[0m:1053: in get
    [0m[94mreturn[39;49;00m [96mself[39;49;00m.request([90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/starlette/testclient.py[0m:486: in request
    [0murl = [96mself[39;49;00m._merge_url(url)[90m[39;49;00m
          ^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/httpx/_client.py[0m:396: in _merge_url
    [0mmerge_url = URL(url)[90m[39;49;00m
                ^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/httpx/_urls.py[0m:117: in __init__
    [0m[96mself[39;49;00m._uri_reference = urlparse(url, **kwargs)[90m[39;49;00m
                          ^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/httpx/_urlparse.py[0m:229: in urlparse
    [0m[94mraise[39;49;00m InvalidURL(error)[90m[39;49;00m
[1m[31mE   httpx.InvalidURL: Invalid non-printable ASCII character in URL, '\x00' at position 12.[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: GET http://testserver/api/etc/passwd/status "HTTP/1.1 404 Not Found"
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: GET http://testserver/api/job/job;DROP%20TABLE%20jobs;/status "HTTP/1.1 404 Not Found"
[31m[1m___________________________ test_upload_missing_file ___________________________[0m
[1m[31mtests/api/test_main_api.py[0m:133: in test_upload_missing_file
    [0m[94massert[39;49;00m response.status_code == [94m422[39;49;00m[90m[39;49;00m
[1m[31mE   assert 404 == 422[0m
[1m[31mE    +  where 404 = <Response [404 Not Found]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: POST http://testserver/api/upload "HTTP/1.1 404 Not Found"
[31m[1m________________________ test_upload_with_mock_parquet _________________________[0m
[1m[31mtests/api/test_main_api.py[0m:150: in test_upload_with_mock_parquet
    [0m[94massert[39;49;00m response.status_code [95min[39;49;00m [[94m200[39;49;00m, [94m400[39;49;00m, [94m422[39;49;00m, [94m500[39;49;00m][90m[39;49;00m
[1m[31mE   assert 404 in [200, 400, 422, 500][0m
[1m[31mE    +  where 404 = <Response [404 Not Found]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: POST http://testserver/api/upload "HTTP/1.1 404 Not Found"
[31m[1m__________________________ test_cors_headers_present ___________________________[0m
[1m[31mtests/api/test_main_api.py[0m:180: in test_cors_headers_present
    [0m[94massert[39;49;00m [33m"[39;49;00m[33maccess-control-allow-origin[39;49;00m[33m"[39;49;00m [95min[39;49;00m response.headers [95mor[39;49;00m response.status_code == [94m200[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: assert ('access-control-allow-origin' in Headers({'allow': 'GET', 'content-length': '31', 'content-type': 'application/json'}) or 405 == 200)[0m
[1m[31mE    +  where Headers({'allow': 'GET', 'content-length': '31', 'content-type': 'application/json'}) = <Response [405 Method Not Allowed]>.headers[0m
[1m[31mE    +  and   405 = <Response [405 Method Not Allowed]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: OPTIONS http://testserver/health "HTTP/1.1 405 Method Not Allowed"
[31m[1m___________________________ test_invalid_http_method ___________________________[0m
[1m[31mtests/api/test_main_api.py[0m:199: in test_invalid_http_method
    [0m[94massert[39;49;00m response.status_code == [94m405[39;49;00m  [90m# Method Not Allowed[39;49;00m[90m[39;49;00m
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE   assert 404 == 405[0m
[1m[31mE    +  where 404 = <Response [404 Not Found]>.status_code[0m
------------------------------ Captured log call -------------------------------
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: GET http://testserver/api/upload "HTTP/1.1 404 Not Found"
[31m[1m______________ TestAverageDependencies.test_average_inputs_per_sp ______________[0m
[1m[31mtests/integration/test_database_validation.py[0m:124: in test_average_inputs_per_sp
    [0m[94massert[39;49;00m [94m2.0[39;49;00m <= avg_inputs <= [94m5.0[39;49;00m, [33mf[39;49;00m[33m"[39;49;00m[33mExpected avg inputs 2-5, got [39;49;00m[33m{[39;49;00mavg_inputs[33m:[39;49;00m[33m.2f[39;49;00m[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Expected avg inputs 2-5, got 1.43[0m
[1m[31mE   assert 2.0 <= 1.4297994269340975[0m
[31m[1m________ TestCompletenessAnalysis.test_completeness_ranges_distribution ________[0m
[1m[31mtests/integration/test_sqlglot_performance.py[0m:135: in test_completeness_ranges_distribution
    [0m[94massert[39;49;00m count == [94m0[39;49;00m, ([90m[39;49;00m
[1m[31mE   AssertionError: Found 349 SPs with <50% completeness (poor)[0m
[1m[31mE   assert 349 == 0[0m
[31m[1m______________ TestSynapseIntegration.test_synapse_schema_columns ______________[0m
[1m[31mtests/integration/test_synapse_integration.py[0m:59: in test_synapse_schema_columns
    [0m[94massert[39;49;00m actual_cols == expected_cols[90m[39;49;00m
[1m[31mE   AssertionError: assert ['command_text'] == ['object_id', 'schema_name', 'object_name', 'object_type', 'create_date', 'modify_date'][0m
[1m[31mE     [0m
[1m[31mE     At index 0 diff: [0m[33m'[39;49;00m[33mcommand_text[39;49;00m[33m'[39;49;00m[90m[39;49;00m != [0m[33m'[39;49;00m[33mobject_id[39;49;00m[33m'[39;49;00m[90m[39;49;00m[0m
[1m[31mE     Right contains 5 more items, first extra item: [0m[33m'[39;49;00m[33mschema_name[39;49;00m[33m'[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [0m
[1m[31mE     Full diff:[0m
[1m[31mE     [0m[90m [39;49;00m [[90m[39;49;00m[0m
[1m[31mE     [92m+     'command_text',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [91m-     'object_id',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [91m-     'schema_name',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [91m-     'object_name',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [91m-     'object_type',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [91m-     'create_date',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [91m-     'modify_date',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [90m [39;49;00m ][90m[39;49;00m[0m
[31m[1m_______________ TestSynapseIntegration.test_synapse_object_types _______________[0m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/indexes/base.py[0m:3812: in get_loc
    [0m[94mreturn[39;49;00m [96mself[39;49;00m._engine.get_loc(casted_key)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mpandas/_libs/index.pyx[0m:167: in pandas._libs.index.IndexEngine.get_loc
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/index.pyx[0m:196: in pandas._libs.index.IndexEngine.get_loc
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/hashtable_class_helper.pxi[0m:7088: in pandas._libs.hashtable.PyObjectHashTable.get_item
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/hashtable_class_helper.pxi[0m:7096: in pandas._libs.hashtable.PyObjectHashTable.get_item
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mE   KeyError: 'object_type'[0m

[33mThe above exception was the direct cause of the following exception:[0m
[1m[31mtests/integration/test_synapse_integration.py[0m:64: in test_synapse_object_types
    [0mobject_types = synapse_data[[33m'[39;49;00m[33mobject_type[39;49;00m[33m'[39;49;00m].unique()[90m[39;49;00m
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/frame.py[0m:4113: in __getitem__
    [0mindexer = [96mself[39;49;00m.columns.get_loc(key)[90m[39;49;00m
              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/indexes/base.py[0m:3819: in get_loc
    [0m[94mraise[39;49;00m [96mKeyError[39;49;00m(key) [94mfrom[39;49;00m[90m [39;49;00m[04m[96merr[39;49;00m[90m[39;49;00m
[1m[31mE   KeyError: 'object_type'[0m
[31m[1m____________ TestSynapseIntegration.test_tsql_schema_compatibility _____________[0m
[1m[31mtests/integration/test_synapse_integration.py[0m:88: in test_tsql_schema_compatibility
    [0m[94massert[39;49;00m col_name [95min[39;49;00m renamed_data.columns, [33mf[39;49;00m[33m"[39;49;00m[33mMissing column: [39;49;00m[33m{[39;49;00mcol_name[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Missing column: database_object_id[0m
[1m[31mE   assert 'database_object_id' in Index(['command_text'], dtype='object')[0m
[1m[31mE    +  where Index(['command_text'], dtype='object') =                                           command_text\n0    select o.type [OBJECT_TYPE], o.create_date [CR...\n1    update [ADMIN].[TABLE_IMPORT_LOG]\r\nset previ...\n2    select top 2048\r\n    [$Ordered].[ADDRESS_ID]...\n3     select * from [CONSUMPTION_PRIMA].[HrAttendance]\n4    SELECT CAST(CASE WHEN (object_id ('CONSUMPTION...\n..                                                 ...\n292  insert bulk [CONSUMPTION_PRIMA].[FeasibilityCo...\n293  select * from [CONSUMPTION_PRIMAREPORTING].[Pr...\n294  SELECT count(name) FROM sys.tables WHERE name=...\n295  SELECT TOP 0 * FROM [CONSUMPTION_PRIMAREPORTIN...\n296  SELECT TOP(1) [p].[STUDY_PHASE] AS [StudyPhase...\n\n[297 rows x 1 columns].columns[0m
[31m[1m_______________ TestSynapseIntegration.test_synapse_data_quality _______________[0m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/indexes/base.py[0m:3812: in get_loc
    [0m[94mreturn[39;49;00m [96mself[39;49;00m._engine.get_loc(casted_key)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mpandas/_libs/index.pyx[0m:167: in pandas._libs.index.IndexEngine.get_loc
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/index.pyx[0m:196: in pandas._libs.index.IndexEngine.get_loc
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/hashtable_class_helper.pxi[0m:7088: in pandas._libs.hashtable.PyObjectHashTable.get_item
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/hashtable_class_helper.pxi[0m:7096: in pandas._libs.hashtable.PyObjectHashTable.get_item
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mE   KeyError: 'object_id'[0m

[33mThe above exception was the direct cause of the following exception:[0m
[1m[31mtests/integration/test_synapse_integration.py[0m:96: in test_synapse_data_quality
    [0m[94massert[39;49;00m synapse_data[[33m'[39;49;00m[33mobject_id[39;49;00m[33m'[39;49;00m].notna().all()[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/frame.py[0m:4113: in __getitem__
    [0mindexer = [96mself[39;49;00m.columns.get_loc(key)[90m[39;49;00m
              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/indexes/base.py[0m:3819: in get_loc
    [0m[94mraise[39;49;00m [96mKeyError[39;49;00m(key) [94mfrom[39;49;00m[90m [39;49;00m[04m[96merr[39;49;00m[90m[39;49;00m
[1m[31mE   KeyError: 'object_id'[0m
[31m[1m____________ TestSynapseIntegration.test_synapse_stored_procedures _____________[0m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/indexes/base.py[0m:3812: in get_loc
    [0m[94mreturn[39;49;00m [96mself[39;49;00m._engine.get_loc(casted_key)[90m[39;49;00m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mpandas/_libs/index.pyx[0m:167: in pandas._libs.index.IndexEngine.get_loc
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/index.pyx[0m:196: in pandas._libs.index.IndexEngine.get_loc
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/hashtable_class_helper.pxi[0m:7088: in pandas._libs.hashtable.PyObjectHashTable.get_item
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mpandas/_libs/hashtable_class_helper.pxi[0m:7096: in pandas._libs.hashtable.PyObjectHashTable.get_item
    [0m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[04m[91m?[39;49;00m[90m[39;49;00m
[1m[31mE   KeyError: 'object_type'[0m

[33mThe above exception was the direct cause of the following exception:[0m
[1m[31mtests/integration/test_synapse_integration.py[0m:111: in test_synapse_stored_procedures
    [0mprocs = synapse_data[synapse_data[[33m'[39;49;00m[33mobject_type[39;49;00m[33m'[39;49;00m].str.contains([33m'[39;49;00m[33mProcedure[39;49;00m[33m'[39;49;00m, case=[94mFalse[39;49;00m, na=[94mFalse[39;49;00m)][90m[39;49;00m
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/frame.py[0m:4113: in __getitem__
    [0mindexer = [96mself[39;49;00m.columns.get_loc(key)[90m[39;49;00m
              ^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mvenv/lib/python3.12/site-packages/pandas/core/indexes/base.py[0m:3819: in get_loc
    [0m[94mraise[39;49;00m [96mKeyError[39;49;00m(key) [94mfrom[39;49;00m[90m [39;49;00m[04m[96merr[39;49;00m[90m[39;49;00m
[1m[31mE   KeyError: 'object_type'[0m
[31m[1m__________ TestSynapseIntegration.test_backward_compatibility_mapping __________[0m
[1m[31mtests/integration/test_synapse_integration.py[0m:161: in test_backward_compatibility_mapping
    [0m[94massert[39;49;00m col_name [95min[39;49;00m new_data.columns, [33mf[39;49;00m[33m"[39;49;00m[33mMissing: [39;49;00m[33m{[39;49;00mcol_name[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Missing: database_object_id[0m
[1m[31mE   assert 'database_object_id' in Index(['command_text'], dtype='object')[0m
[1m[31mE    +  where Index(['command_text'], dtype='object') =                                           command_text\n0    select o.type [OBJECT_TYPE], o.create_date [CR...\n1    update [ADMIN].[TABLE_IMPORT_LOG]\r\nset previ...\n2    select top 2048\r\n    [$Ordered].[ADDRESS_ID]...\n3     select * from [CONSUMPTION_PRIMA].[HrAttendance]\n4    SELECT CAST(CASE WHEN (object_id ('CONSUMPTION...\n..                                                 ...\n292  insert bulk [CONSUMPTION_PRIMA].[FeasibilityCo...\n293  select * from [CONSUMPTION_PRIMAREPORTING].[Pr...\n294  SELECT count(name) FROM sys.tables WHERE name=...\n295  SELECT TOP 0 * FROM [CONSUMPTION_PRIMAREPORTIN...\n296  SELECT TOP(1) [p].[STUDY_PHASE] AS [StudyPhase...\n\n[297 rows x 1 columns].columns[0m
[31m[1m___________ TestCommentHintsParser.test_invalid_hint_format_ignored ____________[0m
[1m[31mtests/unit/test_comment_hints_parser.py[0m:261: in test_invalid_hint_format_ignored
    [0m[94massert[39;49;00m inputs == {[33m'[39;49;00m[33mdbo.Table2[39;49;00m[33m'[39;49;00m}[90m[39;49;00m
[1m[31mE   AssertionError: assert {'dbo.Table2 (valid)'} == {'dbo.Table2'}[0m
[1m[31mE     [0m
[1m[31mE     Extra items in the left set:[0m
[1m[31mE     [0m[33m'[39;49;00m[33mdbo.Table2 (valid)[39;49;00m[33m'[39;49;00m[90m[39;49;00m[0m
[1m[31mE     Extra items in the right set:[0m
[1m[31mE     [0m[33m'[39;49;00m[33mdbo.Table2[39;49;00m[33m'[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [0m
[1m[31mE     Full diff:[0m
[1m[31mE     [0m[90m [39;49;00m {[90m[39;49;00m[0m
[1m[31mE     [91m-     'dbo.Table2',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     [92m+     'dbo.Table2 (valid)',[39;49;00m[90m[39;49;00m[0m
[1m[31mE     ?                ++++++++[90m[39;49;00m[0m
[1m[31mE     [90m [39;49;00m }[90m[39;49;00m[0m
[36m[1m=========================== short test summary info ============================[0m
[33mSKIPPED[0m [1] tests/api/test_main_api.py:214: Integration test - requires real parquet files
[33mSKIPPED[0m [1] tests/api/test_main_api.py:224: Integration test - requires background processing
[33mSKIPPED[0m [1] tests/integration/test_confidence_analysis.py:265: expected_count and found_count not populated (DEBUG logging disabled)
[33mSKIPPED[0m [1] tests/integration/test_failure_analysis.py:111: No failed SPs in database (100% success rate)
[33mSKIPPED[0m [1] tests/integration/test_failure_analysis.py:126: No dynamic SQL only SPs
[33mSKIPPED[0m [1] tests/integration/test_failure_analysis.py:137: No template/empty SPs
[33mSKIPPED[0m [1] tests/integration/test_failure_analysis.py:170: No failed SPs in database (100% success rate)
[33mSKIPPED[0m [1] tests/integration/test_failure_analysis.py:239: No failed SPs (100% success rate)
[33mSKIPPED[0m [1] tests/integration/test_sp_parsing_details.py:138: No phantom objects in database (expected if all deps resolved)
[33mSKIPPED[0m [1] tests/integration/test_sp_parsing_details.py:163: No phantom objects in database
[33mSKIPPED[0m [1] tests/integration/test_sqlglot_performance.py:53: expected_count not populated (DEBUG logging disabled)
[33mSKIPPED[0m [1] tests/integration/test_sqlglot_performance.py:160: No SPs with expected_count data
[33mSKIPPED[0m [1] tests/integration/test_sqlglot_performance.py:183: No expected_count data available
[33mSKIPPED[0m [1] tests/integration/test_sqlglot_performance.py:212: SQLGlot didn't add tables beyond regex baseline (regex sufficient)
[33mSKIPPED[0m [1] tests/integration/test_sqlglot_performance.py:279: No phantom objects in database
[33mSKIPPED[0m [1] tests/integration/test_sqlglot_performance.py:323: No expected_count data available
[33mSKIPPED[0m [1] tests/unit/test_user_verified_cases.py:73: No user-verified cases found (infrastructure ready, add cases when users report issues)
[33mSKIPPED[0m [1] tests/unit/test_user_verified_cases.py:169: No verified cases to check
[31mERROR[0m tests/unit/test_parser_golden_cases.py::[1mTestParserSimplifiedConfidence::test_confidence_is_discrete[0m
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_health_endpoint[0m - AssertionError: assert 'timestamp' in {'status': 'ok', 'version': '4.0.3', 'uptime_seconds': 0.26912546157836914}
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_root_redirects_to_docs[0m - assert 404 in [301, 302, 307, 308]
 +  where 404 = <Response [404 Not Found]>.status_code
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_job_status_invalid_id_format[0m - httpx.InvalidURL: Invalid non-printable ASCII character in URL, '\x00' at position 12.
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_upload_missing_file[0m - assert 404 == 422
 +  where 404 = <Response [404 Not Found]>.status_code
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_upload_with_mock_parquet[0m - assert 404 in [200, 400, 422, 500]
 +  where 404 = <Response [404 Not Found]>.status_code
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_cors_headers_present[0m - AssertionError: assert ('access-control-allow-origin' in Headers({'allow': 'GET', 'content-length': '31', 'content-type': 'application/json'}) or 405 == 200)
 +  where Headers({'allow': 'GET', 'content-length': '31', 'content-type': 'application/json'}) = <Response [405 Method Not Allowed]>.headers
 +  and   405 = <Response [405 Method Not Allowed]>.status_code
[31mFAILED[0m tests/api/test_main_api.py::[1mtest_invalid_http_method[0m - assert 404 == 405
 +  where 404 = <Response [404 Not Found]>.status_code
[31mFAILED[0m tests/integration/test_database_validation.py::[1mTestAverageDependencies::test_average_inputs_per_sp[0m - AssertionError: Expected avg inputs 2-5, got 1.43
assert 2.0 <= 1.4297994269340975
[31mFAILED[0m tests/integration/test_sqlglot_performance.py::[1mTestCompletenessAnalysis::test_completeness_ranges_distribution[0m - AssertionError: Found 349 SPs with <50% completeness (poor)
assert 349 == 0
[31mFAILED[0m tests/integration/test_synapse_integration.py::[1mTestSynapseIntegration::test_synapse_schema_columns[0m - AssertionError: assert ['command_text'] == ['object_id', 'schema_name', 'object_name', 'object_type', 'create_date', 'modify_date']
  
  At index 0 diff: [0m[33m'[39;49;00m[33mcommand_text[39;49;00m[33m'[39;49;00m[90m[39;49;00m != [0m[33m'[39;49;00m[33mobject_id[39;49;00m[33m'[39;49;00m[90m[39;49;00m
  Right contains 5 more items, first extra item: [0m[33m'[39;49;00m[33mschema_name[39;49;00m[33m'[39;49;00m[90m[39;49;00m
  
  Full diff:
  [0m[90m [39;49;00m [[90m[39;49;00m
  [92m+     'command_text',[39;49;00m[90m[39;49;00m
  [91m-     'object_id',[39;49;00m[90m[39;49;00m
  [91m-     'schema_name',[39;49;00m[90m[39;49;00m
  [91m-     'object_name',[39;49;00m[90m[39;49;00m
  [91m-     'object_type',[39;49;00m[90m[39;49;00m
  [91m-     'create_date',[39;49;00m[90m[39;49;00m
  [91m-     'modify_date',[39;49;00m[90m[39;49;00m
  [90m [39;49;00m ][90m[39;49;00m
[31mFAILED[0m tests/integration/test_synapse_integration.py::[1mTestSynapseIntegration::test_synapse_object_types[0m - KeyError: 'object_type'
[31mFAILED[0m tests/integration/test_synapse_integration.py::[1mTestSynapseIntegration::test_tsql_schema_compatibility[0m - AssertionError: Missing column: database_object_id
assert 'database_object_id' in Index(['command_text'], dtype='object')
 +  where Index(['command_text'], dtype='object') =                                           command_text\n0    select o.type [OBJECT_TYPE], o.create_date [CR...\n1    update [ADMIN].[TABLE_IMPORT_LOG]\r\nset previ...\n2    select top 2048\r\n    [$Ordered].[ADDRESS_ID]...\n3     select * from [CONSUMPTION_PRIMA].[HrAttendance]\n4    SELECT CAST(CASE WHEN (object_id ('CONSUMPTION...\n..                                                 ...\n292  insert bulk [CONSUMPTION_PRIMA].[FeasibilityCo...\n293  select * from [CONSUMPTION_PRIMAREPORTING].[Pr...\n294  SELECT count(name) FROM sys.tables WHERE name=...\n295  SELECT TOP 0 * FROM [CONSUMPTION_PRIMAREPORTIN...\n296  SELECT TOP(1) [p].[STUDY_PHASE] AS [StudyPhase...\n\n[297 rows x 1 columns].columns
[31mFAILED[0m tests/integration/test_synapse_integration.py::[1mTestSynapseIntegration::test_synapse_data_quality[0m - KeyError: 'object_id'
[31mFAILED[0m tests/integration/test_synapse_integration.py::[1mTestSynapseIntegration::test_synapse_stored_procedures[0m - KeyError: 'object_type'
[31mFAILED[0m tests/integration/test_synapse_integration.py::[1mTestSynapseIntegration::test_backward_compatibility_mapping[0m - AssertionError: Missing: database_object_id
assert 'database_object_id' in Index(['command_text'], dtype='object')
 +  where Index(['command_text'], dtype='object') =                                           command_text\n0    select o.type [OBJECT_TYPE], o.create_date [CR...\n1    update [ADMIN].[TABLE_IMPORT_LOG]\r\nset previ...\n2    select top 2048\r\n    [$Ordered].[ADDRESS_ID]...\n3     select * from [CONSUMPTION_PRIMA].[HrAttendance]\n4    SELECT CAST(CASE WHEN (object_id ('CONSUMPTION...\n..                                                 ...\n292  insert bulk [CONSUMPTION_PRIMA].[FeasibilityCo...\n293  select * from [CONSUMPTION_PRIMAREPORTING].[Pr...\n294  SELECT count(name) FROM sys.tables WHERE name=...\n295  SELECT TOP 0 * FROM [CONSUMPTION_PRIMAREPORTIN...\n296  SELECT TOP(1) [p].[STUDY_PHASE] AS [StudyPhase...\n\n[297 rows x 1 columns].columns
[31mFAILED[0m tests/unit/test_comment_hints_parser.py::[1mTestCommentHintsParser::test_invalid_hint_format_ignored[0m - AssertionError: assert {'dbo.Table2 (valid)'} == {'dbo.Table2'}
  
  Extra items in the left set:
  [0m[33m'[39;49;00m[33mdbo.Table2 (valid)[39;49;00m[33m'[39;49;00m[90m[39;49;00m
  Extra items in the right set:
  [0m[33m'[39;49;00m[33mdbo.Table2[39;49;00m[33m'[39;49;00m[90m[39;49;00m
  
  Full diff:
  [0m[90m [39;49;00m {[90m[39;49;00m
  [91m-     'dbo.Table2',[39;49;00m[90m[39;49;00m
  [92m+     'dbo.Table2 (valid)',[39;49;00m[90m[39;49;00m
  ?                ++++++++[90m[39;49;00m
  [90m [39;49;00m }[90m[39;49;00m
[31m============= [31m[1m16 failed[0m, [32m161 passed[0m, [33m18 skipped[0m, [31m[1m1 error[0m[31m in 1.90s[0m[31m ==============[0m
